# Mavlink Module
## Mavlink Proxies
Maverick uses *mavlink proxies* to allow multiple connections from the mavlink source.  There are multiple proxy providers, or types, and the configuration and service control of them are automatically generated by Maverick.  The type can be switched by setting a single localconf parameter, eg. to make *mavlink-router* the active proxy for Flight Controller mavlink data:  
`"maverick_fc::mavlink_proxy": "mavlink-router"`
<img src='media/mavlink-proxy.svg' width='75%'>
### Proxy Ports
Maverick sets two proxy environments out of the box - one for FC (Flight Controller) and one for SITL.  There are a default set of endpoints, some of which are reserved or recommended for particular use:  

  | Env | Port | Status
--- | :---: | :---: | ---
TCP | FC | 5770 | Used by MAVROS
TCP | FC | 5771 | <font color='gray'>available</font>
TCP | FC | 5772 | <font color='gray'>available</font>
UDP | FC | 14570 | Vision Landing<br><font color='gray'>(available if not using vision_landing)</font>
UDP | FC | 14571 | Web Interface (Reserved)
UDP | FC | 14572 | <font color='gray'>available</font>
UDPin | FC | 14573 | <font color='gray'>available</font>
UDPin | FC | 14574 | <font color='gray'>available</font>
UDPin | FC | 14575 | <font color='gray'>available</font>
--- | --- | --- | ---
TCP | SITL | 5780 | Used by MAVROS
TCP | SITL | 5781 | <font color='gray'>available</font>
TCP | SITL | 5782 | <font color='gray'>available</font>
UDP | SITL | 14580 | Vision Landing<br><font color='gray'>(available if not using vision_landing)</font>
UDP | SITL | 14581 | Web Interface (Reserved)
UDP | SITL | 14582 | <font color='gray'>available</font>
UDPin | SITL | 14583 | <font color='gray'>available</font>
UDPin | SITL | 14584 | <font color='gray'>available</font>
UDPin | SITL | 14585 | <font color='gray'>available</font>



## Proxy Types
The *mavlink* module installs and configures mavlink-related software and libraries, but also provides instances of these software for other modules.  For example, it provides 'cmavnode', 'mavlink-router' and 'mavproxy' components that are called from the maverick_dev and maverick_fc modules to provide mavlink proxy services for the SITL (dev) and FC (flight) environments.

The maverick_mavlink::cmavnode, maverick_mavlink::mavlink_router and maverick_mavlink::mavproxy parameters are therefore not set by the end user or system builder in localconf, but instead are set by calling modules.

There are however a few parameters in the core maverick_mavlink module manifest that can be set, although in practice they will rarely need to be changed.

### cmavnode
cmavnode is a Mavlink proxy type.  Like the other proxies, the software is compiled and installed by default.  This can be disabled by setting localconf parameter:  
`"maverick_mavlink::cmavnode_install": false`  
The github source repo for the software can be changed by setting localconf parameter:  
`"maverick_mavlink::cmavnode:source": "http://github.com/myfork/cmavnode.git"`  

### mavlink-router
Mavlink-router is a mavlink proxy type from 01org (Intel).  It is installed by default, but can be disabled by setting localconf parameter:  
`"maverick_mavlink::mavlink_router_install": false`  
The github source repo for the software can be changed by setting localconf parameter:  
`"maverick_mavlink::mavlink_router_source": "http://github.com/myfork/mavlink-router.git"`  

### MAVProxy
MAVProxy is the traditional and most mature mavlink proxy type.  It is installed by default, but can be disabled by setting localconf parameter:  
`"maverick_mavlink::mavproxy_install": false`  
By default it is installed using 'pip' and installs the latest release available from pip.  This can be changed to a source install by setting localconf parameter:  
`"maverick_mavlink::mavproxy_type": "source"`  
The github source repo for the source install can be changed by setting localconf parameter:  
`"maverick_mavlink::mavproxy_source": "http://github.com/myfork/mavproxy.git"`  

## Mavlink Applications
### MAVCesium
MAVCesium is a great realtime HUD/map display system for autopilots.  It is currently based on MAVProxy and has a few limitations in it's implementation so is marked 'experimental', but is still a very interesting Proof of Concept.  It is installed by default (but not activated), but this can be disabled by setting localconf parameter:  
`"maverick_mavlink::mavcesium_install": false`  
The default web port is 6790, but this can be altered by setting localconf parameter:  
`"maverick_mavlink::mavcesium_port": 1234`  
MAVCesium uses Bing to retrieve map tiles from.  To specify your own Bing api key, set localconf parameter:  
`"maverick_mavlink::mavcesium_apikey": "xxx"`  
The github source can be changed by setting localconf parameter:  
`"maverick_mavlink::mavcesium_source": "http://github.com/myfork/MAVCesium.git"`  
